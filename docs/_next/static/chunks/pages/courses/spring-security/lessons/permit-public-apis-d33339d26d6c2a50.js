(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[725],{8090:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/courses/spring-security/lessons/permit-public-apis",function(){return c(4014)}])},4621:function(c,a,b){"use strict";var d=b(5893);a.Z=function(a){var c=a.src,b=a.title;return(0,d.jsxs)("div",{className:"p-3",children:[(0,d.jsx)("div",{className:"mb-3 text-secondary text-center",children:(0,d.jsx)("em",{children:b})}),(0,d.jsx)("img",{className:"img-fluid rounded border shadow",src:c,alt:b})]})}},4014:function(f,b,a){"use strict";a.r(b);var g=a(5893),h=a(9963),i=a(130),j=a(7291),k=a(476),l=a(4621),c=a(9827),d=a(9927),e=a(358);b.default=(0,c.default)(function(b){var a=b.githubPath;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("section",{children:[(0,g.jsx)(h.nL,{children:"Permit Public APIs"}),(0,g.jsxs)(i.Z,{children:["We are now aware that the default behaviour of Spring Security secures all the resources. In addition we have configured ",(0,g.jsx)(j.Z,{children:"HttpSecurity"})," to authenticate any HTTP requests using Basic Auth. This enforced us to provide ",(0,g.jsx)("em",{children:"username"})," and ",(0,g.jsx)("em",{children:"password"})," everytime we access an API in order to authenticate ourselves, failing to provide them resulted in ",(0,g.jsx)("em",{children:"401 Unauthorized"})," error."]}),(0,g.jsxs)(i.Z,{children:["However, ",(0,g.jsx)("u",{children:"ListCourses"})," and ",(0,g.jsx)("u",{children:"GetCourse"})," APIs are open for anyone to access without authentication. In this chapter we will relax the access restriction for these APIs using ",(0,g.jsx)(j.Z,{children:"antMatchers()"}),"."]}),(0,g.jsx)(i.Z,{children:"First let's add the Public API urls in a constant class like below:"}),(0,g.jsx)(k.Z,{fileName:"SecurityConstants.java",href:a+"/src/main/java/com/facadecode/spring/security/constant/SecurityConstants.java",children:'\npublic class SecurityConstants {\n    public static final String API_LIST_COURSES = "/api/v1/courses";\n    public static final String API_GET_COURSE = "/api/v1/courses/*";\n\n    public static final String[] PUBLIC_API_LIST = new String[] {\n        API_LIST_COURSES,\n        API_GET_COURSE\n    };\n};\n'})]}),(0,g.jsxs)("section",{children:[(0,g.jsx)(h.aC,{children:"AntMatchers"}),(0,g.jsxs)(i.Z,{children:[(0,g.jsx)(j.Z,{children:"antMatchers()"})," are overloaded methods to configure restrictions for specific urls matching the provided antPattern urls. We can either chain them together with ",(0,g.jsx)(j.Z,{children:"authorizeRequests()"})," or pass it as an argument to the ",(0,g.jsx)(j.Z,{children:"authorizeRequests()"})," in the form of lambda expression."]}),(0,g.jsxs)(i.Z,{children:["Here we are going to use one of the overloaded methods which accepts both ",(0,g.jsx)(j.Z,{children:"HttpMethod"})," and antPattern urls: ",(0,g.jsx)(j.Z,{children:"antMatchers(HttpMethod, String...)"})]}),(0,g.jsx)(k.Z,{fileName:"ApiSecurityConfig.java",href:a+"/src/main/java/com/facadecode/spring/security/config/ApiSecurityConfig.java",children:"      \n@Configuration\npublic class ApiSecurityConfig {\n    @Bean\n    public SecurityFilterChain apiFilterChain(HttpSecurity http) throws Exception {\n        http\n            .authorizeRequests(auth -> auth\n                .antMatchers(GET, PUBLIC_API_LIST).permitAll()\n                .anyRequest().authenticated()\n            )\n            .httpBasic();\n        return http.build();\n    }\n} \n"}),(0,g.jsxs)(i.Z,{children:["As ",(0,g.jsx)("u",{children:"ListCourses"})," and ",(0,g.jsx)("u",{children:"CreateCourse"})," endpoints are the same but with different HttpMethod, we have to specify ",(0,g.jsx)(j.Z,{children:"HttpMethod.GET"})," in the antMatchers to permit only the ",(0,g.jsx)("u",{children:"ListCourses"})," API."]}),(0,g.jsx)(i.Z,{children:"The order in which the antMatchers are defined is important, with most restricted resources defined at the top followed by least restricted resources at the bottom."})]}),(0,g.jsxs)("section",{children:[(0,g.jsx)(h.aC,{children:"Test Public APIs"}),(0,g.jsxs)(i.Z,{children:["Restart the application and access the two Public APIs from Postman by selecting ",(0,g.jsx)(j.Z,{children:"No Auth"})," option in the Authorization tab. With No Auth we are not required to provide ",(0,g.jsx)("em",{children:"username"})," and ",(0,g.jsx)("em",{children:"password"}),". And we can notice the APIs returning the expected response with no authentication required anymore."]}),(0,g.jsx)(l.Z,{src:"/assets/images/spring-security/lesson04-01.png",title:"List of courses returned with No Auth"})]})]})},(0,e.s)(d.Z,"permit-public-apis"))}},function(a){a.O(0,[116,891,637,462,774,888,179],function(){var b;return a(a.s=8090)}),_N_E=a.O()}])